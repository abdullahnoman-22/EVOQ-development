{% comment %}
  Rewards Tab Section
  Shows customer rewards with tabbed interface
{% endcomment %}

<div class="cus-rw-rewards-section" data-section-id="{{ section.id }}">
  <div class="page-width cus-rw-container">
    <h2 class="cus-rw-rewards-title">{{ section.settings.heading | default: 'Select your reward & add it to your next order' }}</h2>
    
    <!-- Tab Navigation -->
    <div class="cus-rw-rewards-tabs">
      <button class="cus-rw-tab-btn cus-rw-active" data-tab="how-it-works">
        {{ section.settings.tab_1_title | default: 'How it works' }}
      </button>
      <button class="cus-rw-tab-btn" data-tab="earn-points">
        {{ section.settings.tab_2_title | default: 'Earn points' }}
      </button>
      <button class="cus-rw-tab-btn" data-tab="tiers">
        {{ section.settings.tab_3_title | default: 'Tiers' }}
      </button>
      <button class="cus-rw-tab-btn" data-tab="faqs">
        {{ section.settings.tab_4_title | default: 'FAQs' }}
      </button>
    </div>

    <!-- Tab Content -->
    <div class="cus-rw-tab-content cus-rw-active" id="how-it-works">
      <div class="cus-rw-rewards-grid">
        {% for block in section.blocks %}
          {% if block.type == 'reward_item' %}
            <div class="cus-rw-reward-voucher" {{ block.shopify_attributes }}>
              {% if block.settings.reward_image != blank %}
                <div class="cus-rw-voucher-image">
                  <img src="{{ block.settings.reward_image | img_url: 'master' }}" 
                       alt="{{ block.settings.reward_image.alt | default: block.settings.reward_title }}"
                       loading="lazy">
                </div>
              {% endif %}
              <div class="cus-rw-voucher-perforations">
                {% for i in (1..12) %}
                  <div class="cus-rw-perforation"></div>
                {% endfor %}
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="cus-rw-tab-content" id="earn-points">
      <div class="cus-rw-points-info">
        <h3>{{ section.settings.earn_points_heading | default: 'How to Earn Points' }}</h3>
        <div class="cus-rw-points-methods">
          {% if section.settings.earn_points_content != blank %}
            {{ section.settings.earn_points_content }}
          {% else %}
            <p>Earn points with every purchase and activity:</p>
            <ul>
              <li>$1 spent = 1 point</li>
              <li>Create account = 100 points</li>
              <li>Write a review = 50 points</li>
              <li>Follow on social = 25 points</li>
            </ul>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="cus-rw-tab-content" id="tiers">
      <div class="cus-rw-tiers-info">
        <h3>{{ section.settings.tiers_heading | default: 'Membership Tiers' }}</h3>
        <div class="cus-rw-tiers-content">
          {% if section.settings.tiers_content != blank %}
            {{ section.settings.tiers_content }}
          {% else %}
            <div class="cus-rw-tier">
              <h4>Bronze (0-999 points)</h4>
              <p>Standard rewards and benefits</p>
            </div>
            <div class="cus-rw-tier">
              <h4>Silver (1,000-4,999 points)</h4>
              <p>15% bonus points on purchases</p>
            </div>
            <div class="cus-rw-tier">
              <h4>Gold (5,000+ points)</h4>
              <p>25% bonus points + exclusive rewards</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="cus-rw-tab-content" id="faqs">
      <div class="cus-rw-faqs-info">
        <h3>{{ section.settings.faqs_heading | default: 'Frequently Asked Questions' }}</h3>
        <div class="cus-rw-faqs-content">
          {% if section.settings.faqs_content != blank %}
            {{ section.settings.faqs_content }}
          {% else %}
            <div class="cus-rw-faq-item">
              <h4>How do I redeem my points?</h4>
              <p>Points can be redeemed at checkout or through your account dashboard.</p>
            </div>
            <div class="cus-rw-faq-item">
              <h4>Do points expire?</h4>
              <p>Points expire 12 months after they are earned.</p>
            </div>
            <div class="cus-rw-faq-item">
              <h4>Can I combine rewards?</h4>
              <p>Only one reward can be used per order.</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.cus-rw-rewards-section {
  margin-top: 110px;
}

.cus-rw-container {
  margin: 0 auto;
}

.cus-rw-rewards-title {
    line-height: 44px;
    text-align: center;
    font-size: 36px;
    font-weight: 600;
    color: #001F5F;
    margin: 20px 0;
    font-family: 'Inter' !important;
}

.cus-rw-rewards-tabs {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 20px;
  border-radius: 8px;
  padding: 4px;
}

.cus-rw-tab-btn {
    padding: 10px 16px;
    background: transparent;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 400;
    color: #6c757d;
    cursor: pointer;
    transition: all 0.2s ease;
}

.cus-rw-tab-btn.cus-rw-active,
.cus-rw-tab-btn:hover {
  background: #1a1a1a;
  color: white;
}

.cus-rw-tab-content {
  display: none;
}

.cus-rw-tab-content.cus-rw-active {
  display: block;
}

.cus-rw-rewards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 24px;
  margin: 0 auto;
}

.cus-rw-reward-voucher {
  position: relative;
  overflow: hidden;
}

.cus-rw-voucher-image {
  width: 100%;
  height: 100%;
  position: relative;
}

.cus-rw-voucher-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 10px;
}

.cus-rw-voucher-perforations {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 100%;
  pointer-events: none;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 -6px;
}

.cus-rw-perforation {
  width: 12px;
  height: 12px;
  background: #f8f9fa;
  border-radius: 50%;
  border: 2px solid #e9ecef;
}

.cus-rw-points-info,
.cus-rw-tiers-info,
.cus-rw-faqs-info {
  max-width: 800px;
  margin: 0 auto;
  text-align: center;
}

.cus-rw-points-info h3,
.cus-rw-tiers-info h3,
.cus-rw-faqs-info h3 {
  font-size: 28px;
  margin-bottom: 24px;
  color: #1a1a1a;
}

.cus-rw-points-methods ul {
  text-align: left;
  max-width: 400px;
  margin: 20px auto;
}

.cus-rw-points-methods li {
  margin-bottom: 8px;
  font-size: 16px;
}

.cus-rw-tier {
  background: white;
  padding: 24px;
  border-radius: 8px;
  margin-bottom: 16px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.cus-rw-tier h4 {
  color: #9333ea;
  margin-bottom: 8px;
}

.cus-rw-faq-item {
  background: white;
  padding: 24px;
  border-radius: 8px;
  margin-bottom: 16px;
  text-align: left;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.cus-rw-faq-item h4 {
  color: #1a1a1a;
  margin-bottom: 12px;
}

@media (max-width: 768px) {
  .cus-rw-rewards-grid {
    display: flex;
    overflow-x: auto;
    gap: 16px;
    padding: 0 20px;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
  }
  
  .cus-rw-rewards-grid::-webkit-scrollbar {
    display: none;
  }
  
  .cus-rw-reward-voucher {
    flex: 0 0 280px;
    aspect-ratio: 16/9;
    min-height: 160px;
    scroll-snap-align: start;
  }

  .cus-rw-voucher-image img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: 10px;
}
  
  .cus-rw-rewards-tabs {
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .cus-rw-tab-btn {
    padding: 10px 16px;
    font-size: 13px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tabBtns = document.querySelectorAll('.cus-rw-tab-btn');
  const tabContents = document.querySelectorAll('.cus-rw-tab-content');
  
  tabBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      const targetTab = this.getAttribute('data-tab');
      
      // Remove active class from all buttons and contents
      tabBtns.forEach(b => b.classList.remove('cus-rw-active'));
      tabContents.forEach(c => c.classList.remove('cus-rw-active'));
      
      // Add active class to clicked button
      this.classList.add('cus-rw-active');
      
      // Show corresponding content
      const targetContent = document.getElementById(targetTab);
      if (targetContent) {
        targetContent.classList.add('cus-rw-active');
      }
    });
  });
});
</script>

{% schema %}
{
  "name": "Rewards Program",
  "tag": "section",
  "class": "cus-rw-rewards-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Select your reward & add it to your next order"
    },
    {
      "type": "text",
      "id": "tab_1_title",
      "label": "Tab 1 Title",
      "default": "How it works"
    },
    {
      "type": "text",
      "id": "tab_2_title", 
      "label": "Tab 2 Title",
      "default": "Earn points"
    },
    {
      "type": "text",
      "id": "tab_3_title",
      "label": "Tab 3 Title", 
      "default": "Tiers"
    },
    {
      "type": "text",
      "id": "tab_4_title",
      "label": "Tab 4 Title",
      "default": "FAQs"
    },
    {
      "type": "text",
      "id": "earn_points_heading",
      "label": "Earn Points Heading",
      "default": "How to Earn Points"
    },
    {
      "type": "richtext",
      "id": "earn_points_content",
      "label": "Earn Points Content"
    },
    {
      "type": "text",
      "id": "tiers_heading", 
      "label": "Tiers Heading",
      "default": "Membership Tiers"
    },
    {
      "type": "richtext",
      "id": "tiers_content",
      "label": "Tiers Content"
    },
    {
      "type": "text",
      "id": "faqs_heading",
      "label": "FAQs Heading", 
      "default": "Frequently Asked Questions"
    },
    {
      "type": "richtext",
      "id": "faqs_content",
      "label": "FAQs Content"
    }
  ],
  "blocks": [
    {
      "type": "reward_item",
      "name": "Reward Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "reward_image",
          "label": "Reward Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Rewards Program",
      "blocks": [
        {
          "type": "reward_item"
        },
        {
          "type": "reward_item"
        },
        {
          "type": "reward_item"
        }
      ]
    }
  ]
}
{% endschema %}